# -*- makefile -*-

CONTIKI_TARGET_DIRS = .
CONTIKI_CORE = contiki-main
CONTIKI_TARGET_MAIN = ${CONTIKI_CORE}.o

ARCH += ADF7023.c
ARCH += adf7023-contiki.c

CONTIKI_TARGET_SOURCEFILES += $(ARCH)
CONTIKI_TARGET_SOURCEFILES += contiki-main.c
CONTIKI_TARGET_SOURCEFILES += slip.c
CONTIKI_TARGET_SOURCEFILES += sensors.c
CONTIKI_TARGET_SOURCEFILES += button-sensor.c

CONTIKI_SOURCEFILES += $(CONTIKI_TARGET_SOURCEFILES)

${warning $(CONTIKI)}
CONTIKIRL78=$(CONTIKI)/cpu/rl78
CONTIKIBOARD=.

CONTIKI_PLAT_DEFS = 

# MCU=arm7tdmi-s

ifeq ($(UIP_CONF_IPV6),1)
CFLAGS += -DWITH_UIP6=1
endif

include $(CONTIKIRL78)/Makefile.rl78

PROG_UART    ?= /dev/ttyUSB1
CONSOLE_UART ?= /dev/ttyUSB0

run: $(CONTIKI_PROJECT).$(TARGET).srec
	~/adi-contiki/github/rl78flash/rl78flash -vv -i -m3 $(PROG_UART) -b500000 -a $<
	# && stty -F $(CONSOLE_UART) 9600 && cat $(CONSOLE_UART)
